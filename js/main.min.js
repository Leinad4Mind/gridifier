var defaultPrefixes=["xs","s","m","l","xl"],defaultMinWidths=[0,25,38,60,90],breakpointCount=0,$controls=$("#controls"),$breakpoints=$("#breakpoints"),$btnAdd=$("#btn-add-breakpoint"),$output=$("#output"),$legacy=$("#legacy"),view=function(a,b){return b||(b={}),b.legacy=$legacy.is(":checked"),prepareTemplate(a,b)},gridUnitWidth=function(a,b){return a/b*100},gridUnitSingle=function(a,b,c,d,e,f,g){var h=!0,i=gridUnitWidth(b,c),j=[[".unit",a,b,c].join("-"),[a,b,c].join("-")].join(", ."),k=[".unit-offset",a,b,c].join("-"),l=[".unit-push",a,b,c].join("-"),m=[".unit-pull",a,b,c].join("-"),n=[];return d.forEach(function(a){i==a&&(h=!1)}),h&&(d.push(i),e.push(j),n.push([j," {\n  width: ",i.toFixed(4),"%;\n}\n\n"].join("")),f&&n.push([k," {\n  margin-left: ",i.toFixed(4),"%;\n}\n\n"].join("")),g&&(n.push([l," {\n  left: ",i.toFixed(4),"%;\n}\n\n"].join("")),n.push([m," {\n  left: -",i.toFixed(4),"%;\n}\n\n"].join("")))),n},gridUnits=function(a,b,c,d){var e=[100],f=[],g=[],h=2,i=1;for(3>b&&(b=3),g.push(view("grid-unit-all-sizes",{prefix:a})),g.push(view("grid-unit-1",{prefix:a})),c&&g.push(view("grid-unit-offset-0",{prefix:a})),d&&g.push(view("grid-unit-push-pull-0",{prefix:a})),h=2;b>=h;h++)for(i=1;h>=i;i++)g=g.concat(gridUnitSingle(a,i,h,e,f,c,d));return g.push([f.join(",").replace(/ /g,"")," {\n  ",view("grid-unit"),"}\n"].join("")),g};$controls.on("keyup change submit",function(a){var b=[],c="";a.preventDefault(),$breakpoints.children().each(function(){var a=$.trim($(this).find(".prefix").val()),c=$.trim($(this).find(".columns").val()),d=$(this).find(".add-offsets").is(":checked"),e=$(this).find(".add-push-pull").is(":checked"),f=$(this).find(".min-width"),g=f.length;g?b.push(view("media-query",{"min-width":$.trim(f.val()),css:gridUnits(a,c,d,e).join("")})):b=b.concat(gridUnits(a,c,d,e))}),c=[view("grid-base",{"grid-unit":view("grid-unit"),main:b.join("")})],$output.html(c)}),$btnAdd.on("click",function(){var a=defaultMinWidths.length-1,b=20,c=new Array(100).join("x");$breakpoints.append(view("breakpoint",{id:breakpointCount,columns:$.trim($breakpoints.children(".breakpoint:last-child").find(".columns").val())||4,prefix:defaultPrefixes[breakpointCount]||c.substr(0,breakpointCount-a)+defaultPrefixes[a],"min-width":defaultMinWidths[breakpointCount]||defaultMinWidths[a]+(breakpointCount-a)*b})),breakpointCount++,$controls.trigger("submit")}),$controls.on("click",".btn-remove-breakpoint",function(a){a.preventDefault(),$(this).parent().parent().remove(),breakpointCount--,$controls.trigger("submit")}),$btnAdd.trigger("click"),$breakpoints.find(".breakpoint-em").html('<span class="infinite">âˆž</span>'),$breakpoints.children().find(".btn-remove-breakpoint, .min-width, .em").remove(),$btnAdd.trigger("click"),$btnAdd.trigger("click"),$btnAdd.trigger("click");